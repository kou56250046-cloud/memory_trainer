<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ§  è¨˜æ†¶åŠ›ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆç§°å·ï¼‹ã‚°ãƒ©ãƒ•å¯¾å¿œï¼‰</title>
<style>
  :root{
    --bg:#0f172a; --panel:#111827; --muted:#94a3b8; --text:#e5e7eb;
    --accent:#22c55e; --danger:#ef4444; --warn:#f59e0b;
  }
  html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;}
  .wrap{max-width:960px;margin:24px auto;padding:0 16px;}
  header{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-bottom:16px}
  .badge{background:#1f2937;padding:6px 10px;border-radius:999px;font-size:12px;color:var(--muted)}
  h1{font-size:clamp(20px,3.6vw,28px);margin:0}
  .grid{display:grid;grid-template-columns:1fr;gap:16px}
  @media (min-width: 960px){ .grid{grid-template-columns: 1fr 320px;} }
  .card{background:var(--panel);border:1px solid #1f2937;border-radius:14px;padding:16px}
  .card h2{margin:0 0 10px;font-size:18px}
  .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  label{font-size:12px;color:var(--muted)}
  input[type="number"],select,textarea{background:#0b1220;border:1px solid #223; color:var(--text);padding:8px;border-radius:10px}
  input[type="file"]{color:var(--muted)}
  textarea{width:100%}
  button{border:0;border-radius:10px;padding:10px 14px;cursor:pointer;font-weight:600}
  .primary{background:var(--accent);color:#052e16}
  .ghost{background:#0b1220;color:var(--text);border:1px solid #223}
  .danger{background:var(--danger);color:#fff}
  .warn{background:var(--warn);color:#171717}
  .muted{color:var(--muted)}
  .words{font-size:20px;line-height:1.8;letter-spacing:.5px}
  .progress{height:10px;background:#0b1220;border-radius:999px;overflow:hidden;border:1px solid #223}
  .bar{height:100%;background:linear-gradient(90deg,#22c55e,#84cc16)}
  .flex{display:flex;gap:10px;align-items:center}
  .chips{display:flex;flex-wrap:wrap;gap:8px;margin:8px 0}
  .chip{background:#0b1220;border:1px solid #223;border-radius:999px;padding:6px 10px;font-size:12px}
  .pill{display:inline-block;background:#0b1220;border:1px dashed #334155;color:#93c5fd;border-radius:999px;padding:4px 8px;font-size:12px}
  .kpi{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
  .kpi .box{background:#0b1220;border:1px solid #223;border-radius:12px;padding:10px;text-align:center}
  canvas{width:100%;height:200px;background:#0b1220;border:1px solid #223;border-radius:12px}
  table{width:100%;border-collapse:collapse}
  th,td{border-bottom:1px solid #1f2937;padding:8px 6px;font-size:13px}
  th{color:#9ca3af;text-align:left}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="wrap">
  <header>
    <h1>ğŸ§  è¨˜æ†¶åŠ›ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</h1>
    <span class="badge">ç§°å·ï¼‹ã‚°ãƒ©ãƒ•å¯¾å¿œ</span>
  </header>

  <div class="grid">
    <!-- å·¦ãƒ¡ã‚¤ãƒ³ -->
    <main class="card" id="main">
      <div class="flex" style="justify-content:space-between;gap:12px;">
        <div class="flex" style="gap:10px;">
          <span class="pill">ãƒ¬ãƒ™ãƒ«ï¼š<b id="levelLabel">åˆç´š</b></span>
          <span class="pill">ãƒ©ã‚¦ãƒ³ãƒ‰ï¼š<b><span id="roundNow">0</span>/<span id="roundTotal">5</span></b></span>
          <span class="pill">è¡¨ç¤ºç§’æ•°ï¼š<b id="secLabel">10ç§’</b></span>
          <span class="pill">å˜èªæ•°ï¼š<b id="nLabel">5èª</b></span>
        </div>
        <button class="ghost" id="resetAll">åˆæœŸåŒ–</button>
      </div>
      <div class="progress" style="margin:12px 0 16px;">
        <div class="bar" id="bar" style="width:0%"></div>
      </div>

      <section id="phaseIntro">
        <h2>ã‚ˆã†ã“ãï¼</h2>
        <p class="muted">å³å´ã®è¨­å®šã‚’èª¿æ•´ã—ã¦ã€Œé–‹å§‹ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</p>
      </section>

      <section id="phaseShow" hidden>
        <h2>è¦šãˆã¦ãã ã•ã„</h2>
        <div class="words" id="words"></div>
        <div class="chips" id="chips"></div>
        <div class="row" style="margin-top:12px;">
          <button class="warn" id="autoHide">â± è‡ªå‹•ã§éš ã™</button>
          <button class="ghost" id="hideNow">ğŸ™ˆ ä»Šã™ãéš ã™</button>
          <span class="muted" id="countdownNote"></span>
        </div>
      </section>

      <section id="phaseAnswer" hidden>
        <h2>æ€ã„å‡ºã—ã¦å…¥åŠ›</h2>
        <textarea id="answer" rows="5" placeholder="ä¾‹ï¼‰å±± å· æµ· ..."></textarea>
        <div class="row" style="margin-top:10px;">
          <button class="primary" id="score">æ¡ç‚¹ â–¶</button>
          <button class="ghost" id="retrySame">âŸ² ã‚„ã‚Šç›´ã—</button>
        </div>
      </section>

      <section id="phaseResult" hidden>
        <h2>çµæœ</h2>
        <div class="kpi">
          <div class="box"><div class="muted">æ­£ç­”ç‡</div><div style="font-size:22px" id="kpiAcc">0%</div></div>
          <div class="box"><div class="muted">ä¸€è‡´</div><div style="font-size:22px" id="kpiHit">0</div></div>
          <div class="box"><div class="muted">è¦‹è½ã¨ã—</div><div style="font-size:22px" id="kpiMiss">0</div></div>
        </div>
        <div class="card" style="background:#0b1220;border:1px dashed #334155;margin-top:8px;">
          <div><b>å‡ºé¡Œï¼š</b><span id="outShown"></span></div>
          <div><b>ä¸€è‡´ï¼š</b><span id="outHit"></span></div>
          <div><b>è¦‹è½ã¨ã—ï¼š</b><span id="outMiss"></span></div>
          <div><b>ä½™åˆ†ï¼š</b><span id="outExtra"></span></div>
        </div>
        <div class="row" style="margin-top:8px;">
          <button class="primary" id="nextRound">æ¬¡ã®ãƒ©ã‚¦ãƒ³ãƒ‰ â–¶</button>
          <button class="ghost" id="finish">çµ‚äº†ã—ã¦ãƒˆãƒƒãƒ—ã¸</button>
        </div>
      </section>
    </main>

    <!-- å³ã‚µã‚¤ãƒ‰ -->
    <aside class="card">
      <h2>è¨­å®š</h2>
      <div class="row">
        <label>ãƒ¬ãƒ™ãƒ«</label>
        <select id="level">
          <option>åˆç´š</option>
          <option>ä¸­ç´š</option>
          <option>ä¸Šç´š</option>
        </select>
      </div>
      <div class="row">
        <label>ãƒ©ã‚¦ãƒ³ãƒ‰æ•°</label>
        <input id="rounds" type="number" min="1" max="20" value="5">
      </div>
      <div class="row">
        <label>è¡¨ç¤ºç§’æ•°</label>
        <input id="seconds" type="number" min="3" max="60" value="10">
      </div>
      <div class="row">
        <label>1ãƒ©ã‚¦ãƒ³ãƒ‰ã®å˜èªæ•°</label>
        <input id="nwords" type="number" min="3" max="20" value="5">
      </div>
      <div class="row">
        <label>ã‚«ã‚¹ã‚¿ãƒ å˜èªãƒªã‚¹ãƒˆ</label>
        <input id="file" type="file" accept=".txt">
      </div>
      <div class="row" style="margin-top:8px;">
        <button class="primary" id="start">ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°é–‹å§‹ â–¶</button>
      </div>
      <hr style="border:1px solid #1f2937">

      <h2>ğŸ… ç§°å·</h2>
      <div id="titleDisplay" style="margin-bottom:8px;"></div>
      <div class="pill">é€£ç¶šè¨˜éŒ²ï¼š<span id="streakDisplay">0</span>æ—¥</div>
      <div class="pill">å¹³å‡æ­£ç­”ç‡ï¼š<span id="avgDisplay">0</span>%</div>
      <hr style="border:1px solid #1f2937">

      <h2>ğŸ“Š æˆç¸¾ã‚°ãƒ©ãƒ•</h2>
      <div class="row" style="margin-bottom:8px;">
        <button class="ghost" data-range="day">æ—¥</button>
        <button class="ghost" data-range="week">é€±</button>
        <button class="ghost" data-range="month">æœˆ</button>
      </div>
      <canvas id="chart" width="600" height="200"></canvas>

      <hr style="border:1px solid #1f2937">
      <h2>å±¥æ­´</h2>
      <div style="max-height:220px;overflow:auto;margin-top:8px">
        <table id="histTable">
          <thead><tr><th>#</th><th>æ—¥æ™‚</th><th>Lv</th><th>æ­£ç­”ç‡</th><th>ä¸€è‡´</th><th>è¦‹è½</th><th>ä½™åˆ†</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
      <div class="row" style="margin-top:8px;">
        <button class="ghost" id="exportCsv">CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
        <button class="danger" id="clearHist">å±¥æ­´ã‚¯ãƒªã‚¢</button>
      </div>
    </aside>
  </div>
</div>

<script>
// ====== ã‚°ãƒ©ãƒ•æç”»ï¼ˆChart.jsï¼‰ ======
function getWeekNumber(date){
  const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));
  const dayNum = d.getUTCDay() || 7;
  d.setUTCDate(d.getUTCDate() + 4 - dayNum);
  const yearStart = new Date(Date.UTC(d.getUTCFullYear(),0,1));
  return Math.ceil((((d - yearStart) / 86400000) + 1)/7);
}
function aggregate(range){
  const groups = {};
  for(const r of state.history){
    const d = new Date(r.timestamp);
    let key = "";
    if(range==="day") key = d.toLocaleDateString();
    else if(range==="week") key = `${d.getFullYear()}-W${getWeekNumber(d)}`;
    else if(range==="month") key = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`;
    if(!groups[key]) groups[key]=[];
    groups[key].push(r.accuracy);
  }
  return Object.entries(groups)
    .map(([k,arr])=>({label:k,avg:arr.reduce((a,b)=>a+b,0)/arr.length}))
    .sort((a,b)=>new Date(a.label)-new Date(b.label));
}
let chartInstance=null;
function drawChart(range="day"){
  const data = aggregate(range);
  const labels = data.map(d=>d.label);
  const values = data.map(d=>Math.round(d.avg));
  const ctx = document.getElementById('chart').getContext('2d');
  if(chartInstance) chartInstance.destroy();
  chartInstance = new Chart(ctx,{
    type:'line',
    data:{ labels, datasets:[{label:`å¹³å‡æ­£ç­”ç‡ï¼ˆ${range}ï¼‰`,data:values,fill:false,borderColor:'#22c55e',tension:0.2}] },
    options:{ responsive:true, scales:{ y:{min:0,max:100,ticks:{callback:v=>v+"%"} } } }
  });
}
document.querySelectorAll('[data-range]').forEach(btn=>{
  btn.addEventListener('click',()=>drawChart(btn.getAttribute('data-range')));
});

// ====== çŠ¶æ…‹ ======
const $ = s => document.querySelector(s);
const state = {
  started:false, round:0, roundsTotal:5,
  level:"åˆç´š", showSeconds:10, nWords:5,
  pool:"å±± å· æµ· ç©º æ˜Ÿ æœˆ èŠ± é³¥ é¢¨ æ£® çŸ³ ç« æ°´ æœ¨ åœŸ å…‰ å¤¢ å¿ƒ æ„› éŸ³".split(" "),
  current:[],
  history: JSON.parse(localStorage.getItem("mt_history")||"[]"),
  titles:  JSON.parse(localStorage.getItem("mt_titles") || "[]"),
  timer:null, secLeft:0
};
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}
function sample(a,n){if(n>a.length)n=a.length;const arr=[...a];shuffle(arr);return arr.slice(0,n);}
function tokens(s){return s.replace(/[ã€,]/g," ").split(/\s+/).map(x=>x.trim()).filter(Boolean);}

// ====== ç§°å· ======
function calcStreak(){
  if(!state.history.length) return 0;
  const days = [...new Set(state.history.map(r=>new Date(r.timestamp).toLocaleDateString()))]
    .sort((a,b)=>new Date(b)-new Date(a));
  const today = new Date().toLocaleDateString();
  let streak=0, current=new Date(today);
  for(const d of days){
    const dd=new Date(d);
    if(dd.toLocaleDateString()===current.toLocaleDateString()){
      streak++; current.setDate(current.getDate()-1);
    } else break;
  }
  return streak;
}
function calcAverageAccuracy(){
  if(!state.history.length) return 0;
  return Math.round(state.history.reduce((a,b)=>a+b.accuracy,0)/state.history.length);
}
function updateTitles(){
  const streak = calcStreak();
  const avg = calcAverageAccuracy();
  const titles = [];
  if(streak>=7)  titles.push("ğŸŒ± é›†ä¸­ã®èŠ½");
  if(streak>=30) titles.push("âš”ï¸ ç¶™ç¶šã®æˆ¦å£«");
  if(avg>=90)    titles.push("ğŸ§  è¨˜æ†¶ã®é”äºº");
  else if(avg>=80) titles.push("ğŸ“˜ å®‰å®šã®è¦šè€…");
  state.titles = titles;
  localStorage.setItem("mt_titles", JSON.stringify(titles));
  localStorage.setItem("mt_streak", streak);
  localStorage.setItem("mt_avg", avg);
  renderTitles();
}
function renderTitles(){
  $("#titleDisplay").innerHTML = state.titles.length ?
    state.titles.map(t=>`<span class="chip">${t}</span>`).join(" ") :
    `<span class="muted">ã¾ã ç§°å·ã¯ã‚ã‚Šã¾ã›ã‚“</span>`;
  $("#streakDisplay").textContent = localStorage.getItem("mt_streak") || 0;
  $("#avgDisplay").textContent    = localStorage.getItem("mt_avg") || 0;
}

// ====== é€²è¡Œ ======
function score(shown,recalled){
  const S=new Set(shown),R=new Set(recalled);
  const hit=[...S].filter(x=>R.has(x)),miss=[...S].filter(x=>!R.has(x)),extra=[...R].filter(x=>!S.has(x));
  const acc= shown.length ? Math.round(100*hit.length/shown.length) : 0;
  return {acc,hit,miss,extra};
}
function setPhase(p){ ["Intro","Show","Answer","Result"].forEach(x=>$("#phase"+x).hidden=p!==x.toLowerCase()); }
function updateBadges(){
  $("#levelLabel").textContent=state.level;
  $("#roundNow").textContent=state.round;
  $("#roundTotal").textContent=state.roundsTotal;
  $("#secLabel").textContent=state.showSeconds+"ç§’";
  $("#nLabel").textContent=state.nWords+"èª";
  $("#bar").style.width=(state.round/state.roundsTotal*100)+"%";
}
function nextRound(){
  state.round++;
  if(state.round>state.roundsTotal){
    alert("å…¨ãƒ©ã‚¦ãƒ³ãƒ‰çµ‚äº†ï¼ãŠã¤ã‹ã‚Œã•ã¾ğŸ‰"); finishToIntro(); return;
  }
  state.current=sample(state.pool,state.nWords);
  $("#words").textContent=state.current.join("ã€");
  $("#chips").innerHTML=state.current.map(w=>`<span class="chip">${w}</span>`).join("");
  $("#answer").value="";
  setPhase("show"); updateBadges();
}

// ====== è¡¨ç¤ºâ†’éè¡¨ç¤ºï¼ˆè‡ªå‹•/æ‰‹å‹•ï¼‰ ======
function clearTimer(){ if(state.timer){ clearInterval(state.timer); state.timer=null; } }
function hideNow(){ clearTimer(); setPhase("answer"); }
function startAutoHide(){
  clearTimer();
  state.secLeft = state.showSeconds;
  $("#countdownNote").textContent = `ã‚ã¨ ${state.secLeft} ç§’ã§éè¡¨ç¤º`;
  state.timer = setInterval(()=>{
    state.secLeft--;
    $("#countdownNote").textContent = `ã‚ã¨ ${state.secLeft} ç§’ã§éè¡¨ç¤º`;
    if(state.secLeft<=0){ clearTimer(); hideNow(); }
  },1000);
}

// ====== å±¥æ­´ãƒ†ãƒ¼ãƒ–ãƒ« ======
function refreshTable(){
  const tb = document.querySelector("#histTable tbody");
  if(!tb) return;
  tb.innerHTML = "";
  state.history.forEach((h,i)=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${i+1}</td><td>${h.timestamp}</td><td>${h.level}</td>
                    <td>${h.accuracy}</td><td>${h.n_hit}</td><td>${h.n_miss}</td><td>${h.n_extra}</td>`;
    tb.appendChild(tr);
  });
}

// ====== ã‚¤ãƒ™ãƒ³ãƒˆ ======
$("#start").addEventListener("click", ()=>{ state.round=0; nextRound(); });
$("#resetAll").addEventListener("click", ()=>{ state.round=0; setPhase("intro"); });
$("#hideNow").addEventListener("click", hideNow);
$("#autoHide").addEventListener("click", startAutoHide);
$("#retrySame").addEventListener("click", ()=> setPhase("show"));
$("#nextRound").addEventListener("click", nextRound);
$("#finish").addEventListener("click", ()=> setPhase("intro"));

$("#score").addEventListener("click", ()=>{
  const rec=tokens($("#answer").value);
  const s=score(state.current,rec);
  $("#kpiAcc").textContent=s.acc+"%";
  $("#kpiHit").textContent=s.hit.length;
  $("#kpiMiss").textContent=s.miss.length;
  $("#outShown").textContent=state.current.join("ã€");
  $("#outHit").textContent=s.hit.length ? s.hit.join("ã€") : "ï¼ˆãªã—ï¼‰";
  $("#outMiss").textContent=s.miss.length ? s.miss.join("ã€") : "ï¼ˆãªã—ï¼‰";
  $("#outExtra").textContent=s.extra.length ? s.extra.join("ã€") : "ï¼ˆãªã—ï¼‰";
  const row={ timestamp:new Date().toLocaleString(), level:state.level, accuracy:s.acc,
              n_hit:s.hit.length, n_miss:s.miss.length, n_extra:s.extra.length };
  state.history.push(row);
  localStorage.setItem("mt_history", JSON.stringify(state.history));
  refreshTable(); drawChart(); updateTitles();
  setPhase("result");
});

// è¨­å®šUI
$("#level").addEventListener("change", e=>{
  state.level=e.target.value;
  state.nWords = (state.level==="åˆç´š")?5 : (state.level==="ä¸­ç´š")?7 : 10;
  document.querySelector("#nwords").value = state.nWords;
  updateBadges();
});
$("#rounds").addEventListener("input", e=>{
  state.roundsTotal = Math.max(1, Math.min(20, Number(e.target.value)||5));
  updateBadges();
});
$("#seconds").addEventListener("input", e=>{
  state.showSeconds = Math.max(3, Math.min(60, Number(e.target.value)||10));
  updateBadges();
});
$("#nwords").addEventListener("input", e=>{
  state.nWords = Math.max(3, Math.min(20, Number(e.target.value)||5));
  updateBadges();
});
$("#file").addEventListener("change", async e=>{
  const file = e.target.files[0]; if(!file) return;
  const text = await file.text();
  const list = text.replace(/\r/g,"").split(/\n|ã€|,|\s+/).map(s=>s.trim()).filter(Boolean);
  if(list.length<3){ alert("å˜èªãŒå°‘ãªã™ãã¾ã™ï¼ˆ3èªä»¥ä¸Šã«ã—ã¦ãã ã•ã„ï¼‰"); return; }
  state.pool = Array.from(new Set(list));
  alert(`å˜èªãƒªã‚¹ãƒˆã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸï¼ˆ${state.pool.length} èªï¼‰`);
});

// åˆæœŸè¡¨ç¤º
(function init(){
  document.querySelector("#level").value = state.level;
  document.querySelector("#rounds").value = state.roundsTotal;
  document.querySelector("#seconds").value = state.showSeconds;
  document.querySelector("#nwords").value = state.nWords;
  updateBadges(); renderTitles(); refreshTable(); drawChart();
})();

// ====== CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ ======
function exportToCSV() {
  if (!state.history.length) {
    alert("å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
    return;
  }
  const header = ["No","æ—¥æ™‚","ãƒ¬ãƒ™ãƒ«","æ­£ç­”ç‡","ä¸€è‡´","è¦‹è½ã¨ã—","ä½™åˆ†"];
  const rows = state.history.map((h,i)=>[
    i+1, h.timestamp, h.level, h.accuracy, h.n_hit, h.n_miss, h.n_extra
  ]);
  const csvContent = [header, ...rows].map(e => e.join(",")).join("\n");

  const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "memory_trainer_history.csv";
  a.style.display = "none";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

// ====== å±¥æ­´ã‚¯ãƒªã‚¢ ======
function clearHistory() {
  if (!confirm("å±¥æ­´ã‚’ã™ã¹ã¦å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) return;
  state.history = [];
  localStorage.removeItem("mt_history");
  refreshTable();
  drawChart();
  updateTitles();
  alert("å±¥æ­´ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸã€‚");
}

// ====== ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ² ======
document.getElementById("exportCsv").addEventListener("click", exportToCSV);
document.getElementById("clearHist").addEventListener("click", clearHistory);

// ğŸ“¥ ã‚«ã‚¹ã‚¿ãƒ å˜èªãƒªã‚¹ãƒˆèª­ã¿è¾¼ã¿ï¼ˆ3000èªå¯¾å¿œç‰ˆï¼‰
document.getElementById("file").addEventListener("change", async (e) => {
  const file = e.target.files[0];
  if (!file) return;

  const text = await file.text();
  // BOMï¼ˆæ–‡å­—åŒ–ã‘å¯¾ç­–ï¼‰
  const cleanText = text.replace(/^\uFEFF/, "");

  // æ”¹è¡Œãƒ»ç©ºç™½ãƒ»ã‚«ãƒ³ãƒãƒ»å…¨è§’ã‚«ãƒ³ãƒãƒ»ã‚¿ãƒ–ãªã©å…¨ã¦ã‚’åŒºåˆ‡ã‚Šæ–‡å­—ã¨ã—ã¦æ‰±ã†
  const list = cleanText.split(/[\n\r\s,ã€\t]+/).map(w => w.trim()).filter(Boolean);

  if (list.length === 0) {
    alert("å˜èªãƒªã‚¹ãƒˆã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¢å¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚");
    return;
  }

  state.pool = list;
  alert(`âœ… ${list.length} èªã®å˜èªãƒªã‚¹ãƒˆã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`);
});

</script>
</body>
</html>
